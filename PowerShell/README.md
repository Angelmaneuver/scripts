# 前提条件

PowerShell スクリプトの実行ポリシーに `Restricted` 以外が設定されている必要がある。

ショートカットサンプルは実行ポリシーを指定して PowerShell を呼び出しているため `Restricted` が指定されていても動作する。

## PowerShell 実行ポリシー

### AllSigned

- スクリプトは実行できます。
- ローカル コンピューター上に記述するスクリプトを含め、すべてのスクリプトと構成ファイルが信頼された発行元によって署名されている必要があります。
- 「信頼済み」または「信頼されていない」に分類していない発行元からのスクリプトを実行する前に、プロンプトが表示されます。
- 符号付きではあるが、悪意のあるスクリプトを実行するリスク。

### Bypass

- 何もブロックされず、警告やプロンプトは表示されません。
- この実行ポリシーは、PowerShell スクリプトが大規模なアプリケーションに組み込まれている構成、または PowerShell に独自のセキュリティ モデルがあるプログラムの基盤となっている構成のために設計されています。

### Default

- 既定の実行ポリシーを設定します。
- Windows クライアントに対する Restricted。
- Windows サーバーに対する RemoteSigned。

### RemoteSigned

- Windows サーバー コンピューターの既定の実行ポリシー。
- スクリプトは実行できます。
- メールやインスタント メッセージ プログラムを含むインターネットからダウンロードされるスクリプトや構成ファイルには、信頼できる発行者からのデジタル署名が必要です。
- インターネットからダウンロードされたものではなく、ローカル コンピューターに書かれたスクリプトにはデジタル署名は必要ありません。
- `Unblock-File` コマンドレットを使用するなどしてスクリプトのブロックが解除された場合、インターネットからダウンロードされた符号なしのスクリプトを実行します。
- インターネット以外からの符号なしのスクリプトや、悪意のある可能性のある符号のあるスクリプトを実行するリスク。

### Restricted

- Windows クライアント コンピューターの既定の実行ポリシー。
- 個々のコマンドは許可されますが、スクリプトは許可されません。
- 書式設定と構成ファイル (`.ps1xml`)、モジュール スクリプト ファイル (`.psm1`)、PowerShell プロファイル (`.ps1`) など、すべてのスクリプト ファイルの実行を防止します。

### Undefined

- 現在のスコープに実行ポリシーが設定されていません。
- すべてのスコープでの実行ポリシーが Undefined である場合、有効な実行ポリシーは Windows クライアントでは Restricted、Windows Server では RemoteSigned になります。

### Unrestricted

- Windows 以外のコンピューターの既定の実行ポリシー。変更することはできません。
- 符号なしのスクリプトは実行できます。 悪意のあるスクリプトが実行されるリスクがあります。
- ローカル イントラネット ゾーン以外のスクリプトや構成ファイルを実行する前に、ユーザーに警告が表示されます。

## PowerShell 実行ポリシーの管理

### 現在の PowerShell セッションで有効な実行ポリシーの確認方法

```
Get-ExecutionPolicy
```

### 実行ポリシーを変更する

```
Set-ExecutionPolicy -ExecutionPolicy <PolicyName>
```
